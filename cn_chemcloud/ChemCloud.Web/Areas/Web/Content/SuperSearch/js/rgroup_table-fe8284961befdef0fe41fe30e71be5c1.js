/****************************************************************************
 * Copyright (C) 2009-2010 GGA Software Services LLC
 *
 * This file may be distributed and/or modified under the terms of the
 * GNU Affero General Public License version 3 as published by the Free
 * Software Foundation and appearing in the file LICENSE.GPL included in
 * the packaging of this file.
 *
 * This file is provided AS IS with NO WARRANTY OF ANY KIND, INCLUDING THE
 * WARRANTY OF DESIGN, MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.
 ***************************************************************************/
if(!window.Prototype)throw new Error("Prototype.js should be loaded first");if(!window.rnd)throw new Error("rnd should be defined prior to loading this file");rnd.RGroupTable=function(e,t,n){t=t||{},e=$(e),e.innerHTML="",this.onClick=t.onClick||function(e){this.setSelection(this.mode=="single"?this.selection==1<<e?0:1<<e:(this.selection^1<<e)&4294967295)};var r=t.buttonHalfSize||16;this.elemHalfSz=new util.Vec2(r,r),this.elemSz=this.elemHalfSz.scaled(2),this.spacing=new util.Vec2(3,3),this.cornerRadius=0,this.orig=this.elemSz.scaled(0),this.mode=t.mode||"multiple",this.selection=0,n&&(this.size=new util.Vec2((this.elemSz.x+this.spacing.x)*8+this.spacing.x,(this.elemSz.y+this.spacing.y)*4+this.spacing.y),e.style.width=this.size.x.toString()+"px",e.style.height=this.size.y.toString()+"px"),this.viewSz=new util.Vec2(e.clientWidth||100,e.clientHeight||100),this.paper=new Raphael(e,this.viewSz.x,this.viewSz.y),this.bb=new util.Box2Abs(new util.Vec2,this.viewSz),this.fillColor=t.fillColor||"#def",this.fillColorSelected=t.fillColorSelected||"#fcb",this.frameColor=t.frameColor||"#9ad",this.frameThickness=t.frameThickness||"1pt",this.fontSize=t.fontSize||18,this.fontType=t.fontType||"Arial",this.frameAttrs={fill:this.fillColor,stroke:this.frameColor,"stroke-width":this.frameThickness},this.fontAttrs={"font-family":this.fontType,"font-size":this.fontSize},this.items=[];for(var i=0;i<32;i++)(function(e){var t=new util.Vec2(this.orig.x+e%8*(this.spacing.x+this.elemSz.x)+this.elemHalfSz.x+this.spacing.x,this.orig.y+parseInt(e/8)*(this.spacing.y+this.elemSz.y)+this.elemHalfSz.y+this.spacing.y),n=this.paper.rect(t.x-this.elemHalfSz.x,t.y-this.elemHalfSz.y,this.elemSz.x,this.elemSz.y,this.cornerRadius).attr(this.frameAttrs),r=this.paper.text(t.x,t.y,"R"+(e+1).toString()).attr(this.fontAttrs),i=this;n.node.onclick=function(){i.onClick(e)},r.node.onclick=function(){i.onClick(e)},this.items[e]={box:n,label:r}}).apply(this,[i])},rnd.RGroupTable.prototype.setMode=function(e){this.mode=e},rnd.RGroupTable.prototype.setSelection=function(e){this.selection=e;for(var t=0;t<32;t++)this.items[t].box.attr("fill",this.selection&1<<t?this.fillColorSelected:this.fillColor)};